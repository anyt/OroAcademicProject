datagrid:
    issues-grid:
        extended_entity_name: Anyt\BugTrackerBundle\Entity\Issue
        source:
            acl_resource: anyt_issue_view
            type: orm
            query:
                select:
                    - i.id
                    - i.code
                    - i.summary
                    - i.type
                    - priorityEntity.title as priority
                    - resolutionEntity.title as resolution
                    - ownerEntity.id as ownerId
                    - CONCAT(ownerEntity.firstName, CONCAT(' ', ownerEntity.lastName)) as owner
                    - assigneeEntity.id as assigneeId
                    - CONCAT(assigneeEntity.firstName, CONCAT(' ', assigneeEntity.lastName)) as assignee
                    - i.created
                    - i.updated
                from:
                    - { table: AnytBugTrackerBundle:Issue, alias: i }
                join:
                    left:
                        - { join: i.owner, alias: ownerEntity}
                        - { join: i.assignee, alias: assigneeEntity}
                        - { join: i.priority, alias: priorityEntity}
                        - { join: i.resolution, alias: resolutionEntity}
                orderBy:
                    - column: i.updated
                      dir: desc
        columns:
            code:
                label: anyt.bugtracker.issue.code.label
            summary:
                label: anyt.bugtracker.issue.summary.label
            type:
                type: twig
                label: anyt.bugtracker.issue.type.label
                frontend_type: html
                template: AnytBugTrackerBundle:Issue:Datagrid/Property/type.html.twig
            priority:
                label: anyt.bugtracker.issue.priority.label
            resolution:
                label: anyt.bugtracker.issue.resolution.label
            owner:
                type: twig
                label: anyt.bugtracker.issue.owner.label
                frontend_type: html
                template: AnytBugTrackerBundle:Issue:Datagrid/Property/owner.html.twig
            assignee:
                type: twig
                label: anyt.bugtracker.issue.assignee.label
                frontend_type: html
                template: AnytBugTrackerBundle:Issue:Datagrid/Property/assignee.html.twig
            created:
                label: Created
                frontend_type: datetime
            updated:
                label: Updated
                frontend_type: datetime
        properties:
            id: ~
            update_link:
                type: url
                route: anyt_issue_update
                params:
                    - id
            view_link:
                type: url
                route: anyt_issue_view
                params:
                    - id
            delete_link:
                type: url
                route: anyt_api_delete_issue
                params:
                    - id
#        sorters:
#            columns:
#                model:
#                    data_name: i.model
#                seats:
#                    data_name: i.seats
#                boughtAt:
#                    data_name: i.boughtAt
#                leasedUntil:
#                    data_name: i.leasedUntil
#            default:
#                model: ASC
#        filters:
#            columns:
#                model:
#                    type: string
#                    data_name: i.model
#                seats:
#                    type: number
#                    data_name: i.seats
#                boughtAt:
#                    type: date
#                    data_name: i.boughtAt
#                leasedUntil:
#                    type: date
#                    data_name: i.leasedUntil
        actions:
            view:
                type:          navigate
                label:         View
                link:          view_link
                icon:          eye-open
                acl_resource:  anyt_issue_view
                rowAction:     true
            update:
                type:          navigate
                label:         Update
                link:          update_link
                icon:          edit
                acl_resource:  anyt_issue_update
            delete:
                type:          delete
                label:         Delete
                link:          delete_link
                icon:          trash
                acl_resource:  anyt_issue_delete

    issues-children-grid:
        extended_entity_name: Anyt\BugTrackerBundle\Entity\Issue
        source:
            acl_resource: anyt_issue_view
            type: orm
            query:
                select:
                    - i.id
                    - i.summary
                from:
                    - { table: AnytBugTrackerBundle:Issue, alias: i }
                where:
                    and:
                        - i.parent = :id
            bind_parameters:
                - id
        columns:
            summary:
                label: Summary
        properties:
            id: ~
            view_link:
                type: url
                route: anyt_issue_view
                params: [ id ]
        actions:
            view:
                type:         navigate
                label:        oro.grid.action.view
                link:         view_link
                icon:         eye-open
                acl_recource: anyt_issue_view
                rowAction:    true
        options:
            toolbarOptions:
                hide: true
                pagination:
                    hide: true
